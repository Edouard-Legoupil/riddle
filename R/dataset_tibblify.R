# WARNING - Generated by {fusen} from /dev/ridlle_dev.Rmd: do not edit by hand

#' dataset_tibblify
#' 
#' Helper function to package API results as a  tibble
#' 
#' @param x dataset as a list
#' @return dataset
#' 
#' @importFrom purrr modify_if negate
#' @importFrom rlang is_empty is_atomic is_list
#' @importFrom tibble as_tibble
#' 
#' @export
#' @examples
#' m <- dataset_metadata(title = "Motor Trend Car Road Tests",
#'                       name = "mtcars",
#'                       notes = "The data was extracted from the 1974 Motor Trend 
#'                       US magazine, and comprises fuel consumption and 10 aspects
#'                       of automobile design and performance for 32 automobiles 
#'                       (1973â€“74 models).",
#'                       owner_org = "americas",  ## becarefull- all lower case!!!
#'                       visibility = "public",
#'                       geographies = "UNSPECIFIED",
#'                       external_access_level = "open_access",
#'                       data_collector = "Motor Trend",
#'                       keywords = keywords[c("Environment", "Other")],
#'                       unit_of_measurement = "car",
#'                       data_collection_technique = "oth",
#'                       archived = "False")
#' 
#' m1 <- dataset_tibblify(m)
#' m1
dataset_tibblify <- function(x) {
  x %>%
    purrr::modify_if(rlang::is_empty, ~NA) %>%
    purrr::modify_if(rlang::is_list, tibble::as_tibble) %>%
    purrr::modify_if(purrr::negate(rlang::is_atomic), list) %>%
    purrr::modify_if(~rlang::is_atomic(.) & length(.) > 1, list) %>%
    tibble::as_tibble()
}
