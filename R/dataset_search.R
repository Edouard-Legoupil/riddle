# WARNING - Generated by {fusen} from /dev/ridlle_dev.Rmd: do not edit by hand

#' Searches for datasets and resources satisfying a given criteria.
#'
#' @name search
#'
#' @param q,query The search query.
#' @param rows The maximum number of matching rows (datasets) to return. (optional, default: 10, upper limit: 1000)
#' @param start The offset in the complete result for where the set of returned datasets should begin.
#'
#' @return A tibble with the search results.
#' @export
#' @examples
#' 
#' # library(riddle)
#' # Sys.setenv(USE_UAT=1)
#' # p <- dataset_search("tests")
#' # p
#' # p$id
dataset_search <- function(q = NULL, rows = NULL, start = NULL) {
  r <- ridl("package_search", !!!(as.list(match.call()[-1])))$results

  if (purrr::is_empty(r))
    return(tibble::tibble())

  r %>%
    dplyr::mutate(dplyr::across(tidyselect::vars_select_helpers$where(is.data.frame),
                                ~purrr::pmap(., ~tibble::tibble(...)))) %>%
    tibble::as_tibble()
}

